{"version":3,"file":"header.js","sources":["../../../../../../../packages/components/table-v2/src/components/header.tsx"],"sourcesContent":["import {\n  computed,\n  defineComponent,\n  inject,\n  nextTick,\n  onUpdated,\n  ref,\n  unref,\n} from 'vue'\nimport { useNamespace } from '@element-plus/hooks'\nimport { ensureArray } from '@element-plus/utils'\nimport { tableV2HeaderProps } from '../header'\nimport { enforceUnit } from '../utils'\nimport { TABLE_V2_GRID_INJECTION_KEY } from '../tokens'\n\nimport type { CSSProperties, Ref, UnwrapRef } from 'vue'\nimport type { TableV2HeaderProps } from '../header'\nimport type { UseColumnsReturn } from '../composables/use-columns'\n\nconst COMPONENT_NAME = 'ElTableV2Header'\nconst TableV2Header = defineComponent({\n  name: COMPONENT_NAME,\n  props: tableV2HeaderProps,\n  setup(props, { slots, expose }) {\n    const ns = useNamespace('table-v2')\n    const scrollLeftInfo = inject<Ref<number>>(TABLE_V2_GRID_INJECTION_KEY)\n\n    const headerRef = ref<HTMLElement>()\n\n    const headerStyle = computed(() =>\n      enforceUnit({\n        width: props.width,\n        height: props.height,\n      })\n    )\n\n    const rowStyle = computed(() =>\n      enforceUnit({\n        width: props.rowWidth,\n        height: props.height,\n      })\n    )\n\n    const headerHeights = computed(() => ensureArray(unref(props.headerHeight)))\n\n    const scrollToLeft = (left?: number) => {\n      const headerEl = unref(headerRef)\n      nextTick(() => {\n        headerEl?.scroll &&\n          headerEl.scroll({\n            left,\n          })\n      })\n    }\n\n    const renderFixedRows = () => {\n      const fixedRowClassName = ns.e('fixed-header-row')\n\n      const { columns, fixedHeaderData, rowHeight } = props\n\n      return fixedHeaderData?.map((fixedRowData, fixedRowIndex) => {\n        const style: CSSProperties = enforceUnit({\n          height: rowHeight,\n          width: '100%',\n        })\n\n        return slots.fixed?.({\n          class: fixedRowClassName,\n          columns,\n          rowData: fixedRowData,\n          rowIndex: -(fixedRowIndex + 1),\n          style,\n        })\n      })\n    }\n\n    const renderDynamicRows = () => {\n      const dynamicRowClassName = ns.e('dynamic-header-row')\n      const { columns } = props\n\n      return unref(headerHeights).map((rowHeight, rowIndex) => {\n        const style: CSSProperties = enforceUnit({\n          width: '100%',\n          height: rowHeight,\n        })\n\n        return slots.dynamic?.({\n          class: dynamicRowClassName,\n          columns,\n          headerIndex: rowIndex,\n          style,\n        })\n      })\n    }\n\n    onUpdated(() => {\n      if (scrollLeftInfo?.value) {\n        scrollToLeft(scrollLeftInfo.value)\n      }\n    })\n    expose({\n      /**\n       * @description scroll to position based on the provided value\n       */\n      scrollToLeft,\n    })\n\n    return () => {\n      if (props.height <= 0) return\n\n      return (\n        <div\n          ref={headerRef}\n          class={props.class}\n          style={unref(headerStyle)}\n          role=\"rowgroup\"\n        >\n          <div style={unref(rowStyle)} class={ns.e('header')}>\n            {renderDynamicRows()}\n            {renderFixedRows()}\n          </div>\n        </div>\n      )\n    }\n  },\n})\n\nexport default TableV2Header\n\nexport type TableV2HeaderInstance = InstanceType<typeof TableV2Header> & {\n  /**\n   * @description scroll to position based on the provided value\n   */\n  scrollToLeft: (left?: number) => void\n}\n\nexport type TableV2HeaderRendererParams = {\n  class: string\n  columns: TableV2HeaderProps['columns']\n  columnsStyles: UnwrapRef<UseColumnsReturn['columnsStyles']>\n  headerIndex: number\n  style: CSSProperties\n}\n\nexport type TableV2HeaderRowRendererParams = {\n  rowData: any\n  rowIndex: number\n} & Omit<TableV2HeaderRendererParams, 'headerIndex'>\n"],"names":["COMPONENT_NAME","TableV2Header","defineComponent","name","props","tableV2HeaderProps","setup","slots","expose","ns","useNamespace","scrollLeftInfo","inject","TABLE_V2_GRID_INJECTION_KEY","headerRef","ref","headerStyle","computed","enforceUnit","width","height","rowStyle","rowWidth","headerHeights","ensureArray","unref","headerHeight","scrollToLeft","left","headerEl","nextTick","scroll","renderFixedRows","fixedRowClassName","e","columns","fixedHeaderData","rowHeight","map","fixedRowData","fixedRowIndex","style","fixed","class","rowData","rowIndex","renderDynamicRows","dynamicRowClassName","dynamic","headerIndex","onUpdated","value","_createVNode"],"mappings":"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"}